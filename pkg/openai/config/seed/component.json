{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "OpenAI Connector Component Spec",
  "type": "object",
  "required": ["task"],
  "properties": {
    "task": {
      "title": "Task",
      "enum": [
        "TASK_TEXT_GENERATION",
        "TASK_TEXT_EMBEDDINGS",
        "TASK_SPEECH_RECOGNITION"
      ],
      "default": "TASK_TEXT_GENERATION"
    }
  },
  "allOf": [
    {
      "if": {
        "properties": {
          "task": {
            "const": "TASK_TEXT_GENERATION"
          }
        }
      },
      "then": {
        "type": "object",
        "required": ["prompt", "model"],
        "properties": {
          "prompt": {
            "type": "string",
            "format": "instill-template-text",
            "$ref": "data.json#/TASK_TEXT_GENERATION/input/properties/prompt"
          },
          "model": {
            "type": "string",
            "format": "instill-template-text",
            "$ref": "data.json#/TASK_TEXT_GENERATION/input/properties/model"
          },
          "system_message": {
            "type": "string",
            "format": "instill-template-text",
            "$ref": "data.json#/TASK_TEXT_GENERATION/input/properties/system_message"
          },
          "temperature": {
            "type": "string",
            "format": "instill-template-number",
            "$ref": "data.json#/TASK_TEXT_GENERATION/input/properties/temperature"
          },
          "n": {
            "type": "string",
            "format": "instill-template-integer",
            "$ref": "data.json#/TASK_TEXT_GENERATION/input/properties/n"
          },
          "max_tokens": {
            "type": "string",
            "format": "instill-template-integer",
            "$ref": "data.json#/TASK_TEXT_GENERATION/input/properties/max_tokens"
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "task": {
            "const": "TASK_TEXT_EMBEDDINGS"
          }
        }
      },
      "then": {
        "type": "object",
        "required": ["text", "model"],
        "properties": {
          "text": {
            "type": "string",
            "format": "instill-template-text",
            "$ref": "data.json#/TASK_TEXT_EMBEDDINGS/input/properties/text"
          },
          "model": {
            "type": "string",
            "format": "instill-template-text",
            "$ref": "data.json#/TASK_TEXT_EMBEDDINGS/input/properties/model"
          }
        }
      }
    },
    {
      "if": {
        "properties": {
          "task": {
            "const": "TASK_SPEECH_RECOGNITION"
          }
        }
      },
      "then": {
        "type": "object",
        "required": ["audio", "model"],
        "properties": {
          "audio": {
            "type": "string",
            "format": "instill-template-audio",
            "$ref": "data.json#/TASK_SPEECH_RECOGNITION/input/properties/audio"
          },
          "model": {
            "type": "string",
            "format": "instill-template-string",
            "$ref": "data.json#/TASK_SPEECH_RECOGNITION/input/properties/model"
          },
          "temperature": {
            "type": "string",
            "format": "instill-template-number",
            "$ref": "data.json#/TASK_SPEECH_RECOGNITION/input/properties/temperature"
          },
          "language": {
            "type": "string",
            "format": "instill-template-text",
            "$ref": "data.json#/TASK_SPEECH_RECOGNITION/input/properties/language"
          },
          "prompt": {
            "type": "string",
            "format": "instill-template-text",
            "$ref": "data.json#/TASK_SPEECH_RECOGNITION/input/properties/prompt"
          }
        }
      }
    }
  ]
}
